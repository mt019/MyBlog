---
title: "初具雛形"
date: 2023-08-09T11:59:10+08:00
lastmod:


tags: 
    - Site
categories:
description:
slug:
draft: false

# include_toc: true
showToc: true
---


## To-do list for my site

1. [x] 為 Navigation Bar 新增 Categories
2. [ ] code block
   1. [x] 增加 copy 按鈕
   2. [x] Line number
   3. [ ] 還要再新增 code block 的 title！
   4. [ ] 最好再調整一下按鈕的位置！
3. [ ] Lastmod 
4. [x] Back-to-top button


 
## 配置文件 `config.yaml` 和 `config.toml` 不可以同時存在？

一直卡住，原來是因為我的路徑中同時存在`config.yaml`和`config.toml`兩個配置文件，打架了啦！只會認一個！

於是我只留下`config.yaml`。終於一切都正常了QQ

自我感動中

## 為 Navigation Bar 新增 Categories

為navigation bar 新增了 Categories（類別） 的 Taxonomies

```yaml:config.yaml
taxonomies:
  categories: categories
  tags: tags
```

```html
<a href="{{ "/categories" | relURL }}">{{ i18n "categories" }}</a>
```
## 改良code block 

### code block example



```html
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Example HTML5 Document</title>
</head>
<body>
  <p>Test</p>
</body>
</html>
```


{{< highlight html >}}
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Example HTML5 Document</title>
</head>
<body>
  <p>Test</p>
</body>
</html>
{{< /highlight >}}



```go:title.js
console.log("Have a nice blog life!!!");
```



{{< codeblock title="test.php" lang="php" >}}
<?php
  echo 'Hello, Mom, I am here.';
?>
{{< /codeblock >}}

### 增加 copy 按鈕 [^1]

[^1]: [Reference for the copy button](https://codepen.io/a-luna/pen/JjYrejL) 



js:

{{< highlight JavaScript >}}
  function createCopyButton(highlightDiv) {
    const button = document.createElement("button");
    button.className = "copy-code-button";
    button.type = "button";
    button.innerText = "Copy";
    button.addEventListener("click", () =>
      copyCodeToClipboard(button, highlightDiv)
    );
    addCopyButtonToDom(button, highlightDiv);
  }
  
  async function copyCodeToClipboard(button, highlightDiv) {
    const codeToCopy = highlightDiv.querySelector(":last-child > .chroma > code")
      .innerText;
    try {
      result = await navigator.permissions.query({ name: "clipboard-write" });
      if (result.state == "granted" || result.state == "prompt") {
        await navigator.clipboard.writeText(codeToCopy);
      } else {
        copyCodeBlockExecCommand(codeToCopy, highlightDiv);
      }
    } catch (_) {
      copyCodeBlockExecCommand(codeToCopy, highlightDiv);
    } finally {
      codeWasCopied(button);
    }
  }
  
  function copyCodeBlockExecCommand(codeToCopy, highlightDiv) {
    const textArea = document.createElement("textArea");
    textArea.contentEditable = "true";
    textArea.readOnly = "false";
    textArea.className = "copyable-text-area";
    textArea.value = codeToCopy;
    highlightDiv.insertBefore(textArea, highlightDiv.firstChild);
    const range = document.createRange();
    range.selectNodeContents(textArea);
    const sel = window.getSelection();
    sel.removeAllRanges();
    sel.addRange(range);
    textArea.setSelectionRange(0, 999999);
    document.execCommand("copy");
    highlightDiv.removeChild(textArea);
  }
  
  function codeWasCopied(button) {
    button.blur();
    button.innerText = "Copied!";
    setTimeout(function () {
      button.innerText = "Copy";
    }, 2000);
  }
  
  function addCopyButtonToDom(button, highlightDiv) {
    highlightDiv.insertBefore(button, highlightDiv.firstChild);
    const wrapper = document.createElement("div");
    wrapper.className = "highlight-wrapper";
    highlightDiv.parentNode.insertBefore(wrapper, highlightDiv);
    wrapper.appendChild(highlightDiv);
  }
  
  document
    .querySelectorAll(".highlight")
    .forEach((highlightDiv) => createCopyButton(highlightDiv));
{{< /highlight >}}


{{< highlight CSS >}}

.copy-code-button {
  position: absolute;
  z-index: 1;
  right: 0;
  top: 0;
  font-size: 13px;
  font-weight: 700;
  line-height: 14px;
  width: 65px;
  color: #232326;
  background-color: #e8d8d8;
  border: 1.25px solid #dbdbf0;
  border-top-left-radius: 0;
  border-top-right-radius: 4px;
  border-bottom-right-radius: 0;
  border-bottom-left-radius: 4px;
  white-space: nowrap;
  padding: 4px 4px 5px 4px;
  margin: 0 0 0 1px;
  cursor: pointer;
  opacity: 0.6;
}

.copy-code-button:hover,
.copy-code-button:focus,
.copy-code-button:active,
.copy-code-button:active:hover {
  color: #222225;
  background-color: #b3b3b3;
  opacity: 0.8;
}

.copyable-text-area {
  position: absolute;
  height: 0;
  z-index: -1;
  opacity: 0.01;
}

{{< /highlight >}}



### 最好再調整一下按鈕的位置！

### 還要再新增 code block 的 title！

```go {title="main.go"}
package main

func main() {
        println("Hugo rules!!!!")
}
```


```javascript:test.js
console.log("Have a nice blog life!!!");
```


## 增加 Back-to-top button [^2]

[^2]: [Reference for the Back-to-top button](https://www.ariesme.com/posts/2019/add_go_top_button_for_hugo/) 

新增：

{{< highlight html >}}
<body>
  <button class="btn" onclick="smoothScrollTop()" id="goTopBtn" title="Go to top">TOP</button>
</body>
{{< /highlight >}}


customCSS:
  - css/back-to-top.css


customJS:
  - js/back-to-top.js

改了CSS中按鈕響應的顏色，改成比較粉色的XD

用平滑向上，感覺滑動速度太慢了！沒耐心

盲猜，修改了一下以下function的數值，從50改成500，果然快了～

{{< highlight JavaScript  "hl_lines=10">}}
//Smooth scroll to the top of the document
function smoothScrollTop(){
    var timer  = null;
    cancelAnimationFrame(timer);
    timer = requestAnimationFrame(function fn(){
        var oTop = document.body.scrollTop || document.documentElement.scrollTop;
        if(oTop > 0){
            document.body.scrollTop = document.documentElement.scrollTop = oTop - 500;
            timer = requestAnimationFrame(fn);
        }else{
            cancelAnimationFrame(timer);
        }
    });
}

{{< /highlight >}}